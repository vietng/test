
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://swft-np.dev.woodside/swft-auth/">
      
      <link rel="icon" href="../assets/logo.jpg">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-8.5.10">
    
    
      
        <title>SWFT Auth - SWFT</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.472b142f.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.08040f6c.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent="">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#introduction-test" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="SWFT" class="md-header__button md-logo" aria-label="SWFT" data-md-component="logo">
      
  <img src="../assets/logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SWFT
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              SWFT Auth
            
          </span>
        </div>
      </div>
    </div>
    
      <form class="md-header__option" data-md-component="palette">
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
          
            <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
          
          
          
          <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="" data-md-color-accent=""  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
          
            <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
            </label>
          
        
      </form>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../isd/" class="md-tabs__link">
      ISD
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link md-tabs__link--active">
      SWFT Auth
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="SWFT" class="md-nav__button md-logo" aria-label="SWFT" data-md-component="logo">
      
  <img src="../assets/logo.jpg" alt="logo">

    </a>
    SWFT
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../isd/" class="md-nav__link">
        ISD
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          SWFT Auth
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        SWFT Auth
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-test" class="md-nav__link">
    Introduction Test
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functional-requirements" class="md-nav__link">
    Functional requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#non-functional-requirements" class="md-nav__link">
    Non functional requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-options" class="md-nav__link">
    Implementation options
  </a>
  
    <nav class="md-nav" aria-label="Implementation options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-full-federation-mode-setup-aws-cognito-to-federate-to-wel-azure-ad-for-wel-users-3rd-party-vendor-idps-for-b2b-external-users-and-social-idps-for-b2c-external-users" class="md-nav__link">
    Option 1 - Full federation mode - Setup AWS Cognito to federate to WEL Azure AD for WEL users, 3rd party vendor IdPs for B2B external users and social IdPs for B2C external users
  </a>
  
    <nav class="md-nav" aria-label="Option 1 - Full federation mode - Setup AWS Cognito to federate to WEL Azure AD for WEL users, 3rd party vendor IdPs for B2B external users and social IdPs for B2C external users">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pros" class="md-nav__link">
    Pros
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cons" class="md-nav__link">
    Cons
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#introduction-test" class="md-nav__link">
    Introduction Test
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#functional-requirements" class="md-nav__link">
    Functional requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#non-functional-requirements" class="md-nav__link">
    Non functional requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#implementation-options" class="md-nav__link">
    Implementation options
  </a>
  
    <nav class="md-nav" aria-label="Implementation options">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-1-full-federation-mode-setup-aws-cognito-to-federate-to-wel-azure-ad-for-wel-users-3rd-party-vendor-idps-for-b2b-external-users-and-social-idps-for-b2c-external-users" class="md-nav__link">
    Option 1 - Full federation mode - Setup AWS Cognito to federate to WEL Azure AD for WEL users, 3rd party vendor IdPs for B2B external users and social IdPs for B2C external users
  </a>
  
    <nav class="md-nav" aria-label="Option 1 - Full federation mode - Setup AWS Cognito to federate to WEL Azure AD for WEL users, 3rd party vendor IdPs for B2B external users and social IdPs for B2C external users">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pros" class="md-nav__link">
    Pros
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cons" class="md-nav__link">
    Cons
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>SWFT Auth</h1>

<h2 id="introduction-test">Introduction Test</h2>
<p>SWFT needs a secure method to enable both vendors (with no WEL accounts) and WEL users to interact with SWFT UI and APIs.</p>
<figure>
<p><img align="center" alt="High level ISD" src="../assets/SWFT-High-Level-ISD.png" width="50%," /> </p>
</figure>
<h2 id="functional-requirements">Functional requirements</h2>
<ol>
<li>FR1: Users (WEL and external vendors) use email addresses as username to authenticate to SWFT. That means:<ul>
<li>Woodside email address for WEL users</li>
<li>Business email address for vendors (B2B external users)</li>
<li>Individual email address for vendors (B2C external users) who don't have an business email setup.</li>
</ul>
</li>
<li>FR2: WEL users must be able to use their existing Woodside credentials (email addresses and passwords) to authenticate to SWFT.</li>
<li>FR3: SWFT must support Single Sign On for WEL users.</li>
<li>FR4: Multiple user accounts per vendor are permitted.</li>
<li>FR5: SWFT must be able to differentiate between external users and WEL users.<ul>
<li>Vendor users can only view and update material lead times belonging to their organisation.</li>
<li>WEL users can perform cross-organisation operations.</li>
</ul>
</li>
<li>FR6: SWFT must comply with WEL security standards and guidelines for authentication and authorisation.</li>
<li>FR7: The auth design must support seamless transitions/migrations when other SWFT products are rolled out.</li>
<li>FR8: The auth supports approximately 20 vendors for the MVP.</li>
<li>FR9: External users must only have access to SWFT and no other WEL services.</li>
</ol>
<h2 id="non-functional-requirements">Non functional requirements</h2>
<ol>
<li>NFR1: External users should be able to use their existing email credentials (email addresses and passwords) to authenticate to SWFT. There is no need to create and manage SWFT-specific credentials.</li>
<li>NFR2: SWFT should support Single Sign On for external users. This requires:<ul>
<li>B2B setup for business-email vendors</li>
<li>B2C setup for individual-email vendors</li>
</ul>
</li>
<li>NFR3: External users might self sign up for SWFT if permitted to do so.</li>
<li>NFR4: SWFT uses a unified interface to authenticate both WEL users and external users.</li>
</ol>
<div class="admonition note">
<p class="admonition-title">SWFT preferred implementation</p>
<ul>
<li>1st preference Option 2</li>
<li>2nd preference Option 1</li>
</ul>
</div>
<h2 id="implementation-options">Implementation options</h2>
<h3 id="option-1-full-federation-mode-setup-aws-cognito-to-federate-to-wel-azure-ad-for-wel-users-3rd-party-vendor-idps-for-b2b-external-users-and-social-idps-for-b2c-external-users">Option 1 - Full federation mode - Setup AWS Cognito to federate to WEL Azure AD for WEL users, 3rd party vendor IdPs for B2B external users and social IdPs for B2C external users</h3>
<ul>
<li>WEL users login using their WEL credentials using a federated IdP setup with WEL Azure AD. See here for a step-by-step guide on how to federate to Azure AD using SAML.</li>
<li>For B2B vendor users, configure Cognito to federate to the vendor IdP (similar to WEL Azure AD). Cognito supports both SAML and OIDC IdPs.</li>
<li>For or B2C vendor users, enable Social identity providers support in Cognito (such as Google, Facebook).
Use Cognito user pool as the authoriser to authorise API access (see here)</li>
</ul>
<pre class="mermaid"><code>sequenceDiagram
    autonumber
    actor user as SWFT users (both WEL and external)
    participant ui as SWFT Front-end
    participant authui as Cognito Hosted Login UI
    participant welui as WEL Login UI
    participant rdui as 3rd party Login UI

    participant api as SWFT API Gateway

    participant auth as AWS Cognito
    participant welauth as WEL Azure Ad
    participant rdauth as 3rd party Identity Provider

    user -&gt;&gt; ui: Open SWFT in browser
    ui -&gt;&gt; ui: Check whether vendor is already logged in

    alt not authenticated
        ui -&gt;&gt; authui: Redirect to Cognito built-in Login page
        user -&gt;&gt; authui: Select method to login (Google, WEL portal, etc)
        alt WEL users
            authui -&gt;&gt; welui: Redirect to WEL Login page
            user -&gt;&gt; welui: Enter credentials
            welui -&gt;&gt; welauth: Submit WEL user credentials
            welauth -&gt;&gt; welauth: Process login credentials
            welauth --&gt;&gt; auth: Successful authentication
        else External B2B and B2C users
            authui -&gt;&gt; rdui: Redirect to 3rd-party IdP login page (including social login)
            user -&gt;&gt; rdui: Enter credentials
            rdui -&gt;&gt; rdauth: Submit user credentials
            rdauth -&gt;&gt; rdauth: Process login credentials
            rdauth --&gt;&gt; auth: Successful authentication
        end
    end
    auth -&gt;&gt; auth: Generate auth code
    auth --&gt;&gt; ui: return auth code
    ui -&gt;&gt; auth: Request for OAuth tokens using auth code and client id
    auth -&gt;&gt; auth: Generate access token, id token, refresh token
    auth --&gt;&gt; ui: Return tokens

    ui -&gt;&gt; api: Access protected resource
    api -&gt;&gt; auth: Ask to perform auth check
    auth -&gt;&gt; auth: Perform auth check
    auth --&gt;&gt; api: authorised
    api --&gt;&gt; ui: Return requested resource</code></pre>
<h4 id="pros">Pros</h4>
<ol>
<li>Cognito is a robust and secure Auth-As-A-Service option. Cognito is HIPAA eligible and PCI DSS, SOC, and ISO/IEC 27001, ISO/IEC 27017, ISO/IEC 27018, and ISO 9001 compliant.</li>
<li>The squad can move fast as the only dependency is to integrate with WEL Azure AD. The SWFT team controls and configures 3rd party Idp and social integrations.</li>
<li>Cognito offers a hosted login page which is hardened by AWS.</li>
<li>Fuse has implemented this pattern for Petronas users. See https://confluence.woodside.com.au/x/W6EnBg.</li>
<li>All users (WEL and external users) can use their existing credentials (usernames and passwords) to authenticate to SWFT. There is no SWFT specific credentials for vendors to manage.</li>
<li>Very flexible option with the ability to customise auth steps with AWS Lambda.</li>
</ol>
<h4 id="cons">Cons</h4>
<ol>
<li>Whitelisting vendor users (in either B2B or B2C setup) requires custom Cognito authentication hooks. See here. Alternatively, for B2B accounts, the vendor can help setup custom scopes for SWFT applications.</li>
<li>Since all OAuth tokens are issued by Cognito, if SWFT API is to be hosted on Mule, there are additional auth work required.</li>
<li>Need to customise Cognito UI to have WEL look and feel.</li>
<li>Cognito has not been used in Accelerator. This would require substantial effort to get the pattern approved.</li>
<li>Overhead to maintain Cognito infrastructure and information.</li>
<li>There are some user information (email address, name) maintained outside WEL Azure AD. Having said that, there is no information identified as Confidential PIR.</li>
</ol>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../isd/" class="md-footer__link md-footer__link--prev" aria-label="Previous: ISD" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              ISD
            </div>
          </div>
        </a>
      
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "search": "../assets/javascripts/workers/search.16e2a7d4.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6c3db9e.min.js"></script>
      
    
  </body>
</html>